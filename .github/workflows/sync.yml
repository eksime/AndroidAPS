name: Merge Upstream

on:
  workflow_dispatch:
  
  schedule:
  - cron: "* * * * *"

jobs:
  merge-upstream:
    runs-on: self-hosted

    steps:
    - uses: actions/checkout@v2
    - name: Clean
      run: git clean -df
    - name: Add Remote
      continue-on-error: true
      run: git remote add -f upstream "https://github.com/nightscout/AndroidAPS.git"
    - name: Checkout
      run: git checkout master
    - name: Merge
      run: git merge --ff-only upstream/master
    - name: Push
      run: git push 
